<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>AS399X Firmware: usb_commands.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">AS399X Firmware
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">usb_commands.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;c8051F340.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="as399x__config_8h_source.html">as399x_config.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="platform_8h_source.html">platform.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="as399x_8h_source.html">as399x.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="global_8h_source.html">global.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="gen2_8h_source.html">gen2.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="as399x__public_8h_source.html">as399x_public.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="as399x__com_8h_source.html">as399x_com.h</a>&quot;</code><br/>
<code>#include &quot;F3xx_Blink_Control.h&quot;</code><br/>
<code>#include &quot;F3xx_USB0_ReportHandler.h&quot;</code><br/>
<code>#include &quot;F3xx_USB0_InterruptServiceRoutine.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="usb__commands_8h_source.html">usb_commands.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="uart_8h_source.html">uart.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="iso6b_8h_source.html">iso6b.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="timer_8h_source.html">timer.h</a>&quot;</code><br/>
<code>#include &quot;string.h&quot;</code><br/>
<code>#include &quot;F340_FlashPrimitives.h&quot;</code><br/>
</div>
<p><a href="usb__commands_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7ec784645e8f3c1d79cbdddc7286da5d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#a7ec784645e8f3c1d79cbdddc7286da5d">writeRegister</a> (void)</td></tr>
<tr class="separator:a7ec784645e8f3c1d79cbdddc7286da5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8d6976460a3b73111e2a912d3d90832"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#af8d6976460a3b73111e2a912d3d90832">writeToTag6B</a> (void)</td></tr>
<tr class="separator:af8d6976460a3b73111e2a912d3d90832"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd7fc5d51767a9bc6e0eb5b7c74c1920"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#acd7fc5d51767a9bc6e0eb5b7c74c1920">readFromTag6B</a> (void)</td></tr>
<tr class="separator:acd7fc5d51767a9bc6e0eb5b7c74c1920"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d0e7a549e38dc3fa3400c2ac7d6a6b9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#a4d0e7a549e38dc3fa3400c2ac7d6a6b9">genericCommand</a> (void)</td></tr>
<tr class="separator:a4d0e7a549e38dc3fa3400c2ac7d6a6b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6a025a7f083c3f69b3c8cefad179f9e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#ad6a025a7f083c3f69b3c8cefad179f9e">callSendFirmwareHardwareID</a> (void)</td></tr>
<tr class="separator:ad6a025a7f083c3f69b3c8cefad179f9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ce0eb2bd02ab534a95f522442fda919"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#a2ce0eb2bd02ab534a95f522442fda919">callUpdateAntennaPower</a> (void)</td></tr>
<tr class="separator:a2ce0eb2bd02ab534a95f522442fda919"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0c3c7d6c275324c7abb8d2915ce1f1d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#aa0c3c7d6c275324c7abb8d2915ce1f1d">callAntennaPower</a> (void)</td></tr>
<tr class="separator:aa0c3c7d6c275324c7abb8d2915ce1f1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a210112a5bcbefccae266f10a543f5b0b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#a210112a5bcbefccae266f10a543f5b0b">callReadRegister</a> (void)</td></tr>
<tr class="separator:a210112a5bcbefccae266f10a543f5b0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bb268c52ce1fb531876c6d8408e4afa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#a4bb268c52ce1fb531876c6d8408e4afa">configGen2</a> ()</td></tr>
<tr class="separator:a4bb268c52ce1fb531876c6d8408e4afa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c83f096f7991bfe2e940326ec280427"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#a2c83f096f7991bfe2e940326ec280427">callAntennaTune</a> (void)</td></tr>
<tr class="separator:a2c83f096f7991bfe2e940326ec280427"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f9f23c6aa727b21a4a93c9db9e886d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#a8f9f23c6aa727b21a4a93c9db9e886d2">callReadRegisters</a> (void)</td></tr>
<tr class="separator:a8f9f23c6aa727b21a4a93c9db9e886d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0084a821c065f158145ea30fbfb1c7a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#aa0084a821c065f158145ea30fbfb1c7a">callInventory6B</a> (void)</td></tr>
<tr class="separator:aa0084a821c065f158145ea30fbfb1c7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfa43c7d6ee4232592efb290888fb847"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#adfa43c7d6ee4232592efb290888fb847">callInventory</a> (void)</td></tr>
<tr class="separator:adfa43c7d6ee4232592efb290888fb847"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafc4e4a9a043305cdd5d3d547112fae7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#aafc4e4a9a043305cdd5d3d547112fae7">callInventoryRSSIInternal</a> (<a class="el" href="as399x__config_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> startInvent)</td></tr>
<tr class="separator:aafc4e4a9a043305cdd5d3d547112fae7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34b95e06e77ecac99ce20894c4767f99"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#a34b95e06e77ecac99ce20894c4767f99">callSelectTag</a> (void)</td></tr>
<tr class="separator:a34b95e06e77ecac99ce20894c4767f99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b5124948787e4620bba229d08ea33ff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#a6b5124948787e4620bba229d08ea33ff">callWriteToTag</a> (void)</td></tr>
<tr class="separator:a6b5124948787e4620bba229d08ea33ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedfb9442ef8ad6a06ce1113820bd41e6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#aedfb9442ef8ad6a06ce1113820bd41e6">callChangeFreq</a> (void)</td></tr>
<tr class="separator:aedfb9442ef8ad6a06ce1113820bd41e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e8235cc0b2cb1df5b04a0847f0a0765"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#a1e8235cc0b2cb1df5b04a0847f0a0765">callReadFromTag</a> (void)</td></tr>
<tr class="separator:a1e8235cc0b2cb1df5b04a0847f0a0765"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc34cc08db5c6dc3443c48ce4625e916"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#abc34cc08db5c6dc3443c48ce4625e916">callLockUnlock</a> (void)</td></tr>
<tr class="separator:abc34cc08db5c6dc3443c48ce4625e916"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d55f0bf20c6e53f25602cf3f15ee3a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#a6d55f0bf20c6e53f25602cf3f15ee3a8">callKillTag</a> (void)</td></tr>
<tr class="separator:a6d55f0bf20c6e53f25602cf3f15ee3a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d980864087ec271634f7d835433ccd4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#a9d980864087ec271634f7d835433ccd4">callNXPCommands</a> (void)</td></tr>
<tr class="separator:a9d980864087ec271634f7d835433ccd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bf612f7a9aff82086a51aab0863a649"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#a0bf612f7a9aff82086a51aab0863a649">callEnableBootloader</a> (void)</td></tr>
<tr class="separator:a0bf612f7a9aff82086a51aab0863a649"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6958165c8330ea8d526edf669d0cb5e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#a6958165c8330ea8d526edf669d0cb5e3">callStartStop</a> (void)</td></tr>
<tr class="separator:a6958165c8330ea8d526edf669d0cb5e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ace606c7581d4f55458cb084cd08f108f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="as399x__config_8h.html#a40236c8c1d02f94f1fb4669ca607769d">XDATA</a> <a class="el" href="as399x__public_8h.html#a24e956eab72b3e331706283669924255">Tag</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#ace606c7581d4f55458cb084cd08f108f">tags_</a> [<a class="el" href="global_8h.html#adf4e7d5cd456c172af91b499031d5649">MAXTAG</a>]</td></tr>
<tr class="separator:ace606c7581d4f55458cb084cd08f108f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c2b775bf7bbfb38b6ce8188078754cd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="as399x__config_8h.html#a40236c8c1d02f94f1fb4669ca607769d">XDATA</a> <a class="el" href="as399x__config_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__commands_8c.html#a5c2b775bf7bbfb38b6ce8188078754cd">mask</a> [<a class="el" href="global_8h.html#a81cf63c63ff9c5236c24a0ceea9e90fd">EPCLENGTH</a>]</td></tr>
<tr class="separator:a5c2b775bf7bbfb38b6ce8188078754cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions which handle commands received via USB(HID) or UART. </p>
<p>This file contains all functions for processing commands received via either HID or UART. It implements the parsing of reports data and sending data back. <br/>
The frequency hopping is also done in this file before calling protocol/device specific functions.</p>
<dl class="section author"><dt>Author</dt><dd>Ulrich Herrmann </dd>
<dd>
Bernhard Breinbauer </dd>
<dd>
Wolfgang Reichart </dd></dl>

<p>Definition in file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aa0c3c7d6c275324c7abb8d2915ce1f1d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callAntennaPower </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function enables/disables the RF field. The format of the report from the host is as follows: </p>
<table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th><th>5 </th><th>6 </th><th>7 </th><th>8 </th><th>9 </th><th>10 </th><th>11 </th><th>12 </th><th>13  </th></tr>
<tr>
<th>Content </th><td>0x18(ID) </td><td>13(length) </td><td>set_power </td><td>0x00: power off<br/>
0xFF: power on </td><td>eval_mode </td><td>set_sensitivity </td><td>sensitivity </td><td>set_port </td><td>port id </td><td>set_level </td><td>Transmit Power Level LSB </td><td>Transmit Power Level MSB </td><td>set_post_pa_switch </td><td>post_pa_switch  </td></tr>
</table>
<p>The parameters are only being set if the proper set_ value is set to 1.<br/>
If eval_mode is set the automatic power regulation will be disabled. eval_mode will be only set if set_power_enable is set to 1.<br/>
The bytes 6 to 12 are only available on ROLAND and ARNIE boards.<br/>
 The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th><th>5 </th><th>6 </th><th>7 </th><th>8 </th><th>9 </th><th>10 </th><th>11 </th><th>12 </th><th>13  </th></tr>
<tr>
<th>Content </th><td>0x19(ID) </td><td>13(length) </td><td>reserved(0) </td><td>0 on success </td><td>reserved(0) </td><td>reserved(0) </td><td>sensitivity </td><td>reserved (0) </td><td>antenna id </td><td>reserved (0) </td><td>desired Transmit Power LSB </td><td>desired Transmit Power MSB </td><td>current Transmit Power LSB </td><td>current Transmit Power MSB  </td></tr>
</table>
<p>Also in the reply of the device the bytes 4 to 12 are only available on ROLAND and ARNIE boards.<br/>
 Values for the different parameters are: </p>
<table class="doxtable">
<tr>
<th>Name</th><th>values </th></tr>
<tr>
<td>sensitivity</td><td>-128 .. 127 (dBm)  </td></tr>
<tr>
<td>antenna id</td><td>1: Antenna port 1<br/>
 2: Antenna port 2  </td></tr>
<tr>
<td>Transmit Power</td><td>The desired transmit power which should be set.  </td></tr>
<tr>
<td>post_pa_switch</td><td>Switch just after PA, switches between normal operation and power detector.  </td></tr>
</table>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l00537">537</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2c83f096f7991bfe2e940326ec280427"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callAntennaTune </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function sets and reads antenna tuner network related values. The network looks like this:</p>
<div class="fragment"><div class="line">                       .--- L ---.</div>
<div class="line">                       |        |</div>
<div class="line">in ----.----.----- L --.--C_len--.--.-----.-----.----- out</div>
<div class="line">       |    |                      |     |     |</div>
<div class="line">      C_in  L                     C_out   L     R</div>
<div class="line">       |    |                      |     |     |</div>
<div class="line">      ___  ___                    ___   ___   ___</div>
<div class="line">       -    -                      -     -     -</div>
<div class="line">       <span class="stringliteral">&#39;    &#39;</span>                      <span class="stringliteral">&#39;     &#39;</span>     <span class="stringliteral">&#39;</span></div>
</div><!-- fragment --><p> where </p>
<ul>
<li>
C_* = 32 steps from 1.3pF to 5.5pF, step size 0.131pF, +-10%  </li>
</ul>
<p>The format of the report from the host is one of the following: </p>
<ul>
<li>
Get/Set current tuner parameters: <table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th><th>5 </th><th>6 </th><th>7 </th><th>8 </th><th>9  </th></tr>
<tr>
<th>Content </th><td>0x5b(ID) </td><td>length </td><td>1 </td><td>set_cin </td><td>cin </td><td>set_clen </td><td>clen </td><td>set_cout </td><td>cout </td><td>auto_tune  </td></tr>
</table>
The values are only being set if the proper set_ value is set to 1. The device sends back: <table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th><th>5 </th><th>6 </th><th>7 </th><th>8  </th></tr>
<tr>
<th>Content </th><td>0x5c(ID) </td><td>0x40(length) </td><td>1 </td><td>status </td><td>cin </td><td>reserved(0) </td><td>clen </td><td>reserved(0) </td><td>cout  </td></tr>
</table>
Values for c* paramaters range from 0 to 31, c=1.3pF + val*0.131pF.<br/>
  </li>
<li>
Delete current tuning table: <table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2  </th></tr>
<tr>
<th>Content </th><td>0x5b(ID) </td><td>length </td><td>2  </td></tr>
</table>
The device sends back: <table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2 </th><th>3 </th><th>4  </th></tr>
<tr>
<th>Content </th><td>0x5c(ID) </td><td>0x40(length) </td><td>2 </td><td>0xFF on success </td><td>maximum tuning table size this device supports  </td></tr>
</table>
</li>
<li>
Add new entry in tuning table: <table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2 </th><th>3..5 </th><th>6 </th><th>7 </th><th>8 </th><th>9 </th><th>10..11 </th><th>12 </th><th>13 </th><th>14 </th><th>15 </th><th>16..17  </th></tr>
<tr>
<th>Content </th><td>0x5b(ID) </td><td>length </td><td>3 </td><td>frequency </td><td>Ant1: tune enable </td><td>Ant1: cin </td><td>Ant1: clen </td><td>Ant1: cout </td><td>Ant1: I+Q </td><td>Ant2: tune enable </td><td>Ant2: cin </td><td>Ant2: clen </td><td>Ant2: cout </td><td>Ant2: I+Q  </td></tr>
</table>
Adds the data to the internal tuning table. The first set of data is for antenna 1 the second set for antenna 2. <br/>
The device responds: <table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2 </th><th>3  </th></tr>
<tr>
<th>Content </th><td>0x5c(ID) </td><td>0x40(length) </td><td>3 </td><td>0xFF on success  </td></tr>
</table>
</li>
<li>
If the device does not support antenna tuning, the device always sends back: <table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2  </th></tr>
<tr>
<th>Content </th><td>0x5c(ID) </td><td>0x40(length) </td><td>0  </td></tr>
</table>
</li>
</ul>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l01115">1115</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="aedfb9442ef8ad6a06ce1113820bd41e6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callChangeFreq </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This sets/adds/measures frequency related stuff: The format of the report from the host is one of the following </p>
<ul>
<li>
Get RSSI level <table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3 .. 5 </th></tr>
<tr>
<th>Content</th><td>0x41(ID)</td><td>length</td><td>1</td><td>freq  </td></tr>
</table>
to which the reader replies with this: <table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4 </th></tr>
<tr>
<th>Content</th><td>0x42(ID)</td><td>64(length)</td><td>I-channel</td><td>Q-channel</td><td>dBm </td></tr>
</table>
</li>
<li>
Get Reflected Power level <table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3 .. 5</th><th>6 </th></tr>
<tr>
<th>Content</th><td>0x41(ID)</td><td>length</td><td>2</td><td>freq </td><td>set_tune </td></tr>
</table>
If set_tune is set the corresponding tuning table value for this frequency will be set before measuring the reflected power.<br/>
The reader replies with this: <table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4 </th></tr>
<tr>
<th>Content</th><td>0x42(ID)</td><td>64(length)</td><td>I-channel</td><td>Q-channel</td><td>dBm </td></tr>
</table>
</li>
<li>
Add frequency to frequency list used for hopping <table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3 .. 5</th><th>6</th><th>7 </th><th>8 </th><th>9 </th><th>10 </th><th>11 </th><th>12 </th><th>13 </th><th>14 </th><th>15 </th><th>16  </th></tr>
<tr>
<th>Content</th><td>0x41(ID)</td><td>length</td><td>4</td><td>freq </td><td>rssi_threshhold(dBm)</td><td>profile_id</td><td>setTune</td><td>tuneEnable1</td><td>Cin1</td><td>Clen1</td><td>Cout1</td><td>tuneEnable2</td><td>Cin2</td><td>Clen2</td><td>Cout2 </td></tr>
</table>
which adds the freq to list used for frequency hopping. If setTune is not 0 the tuning parameters for antenna 1 and 2 will be set. tuneEnableX enables the tune parameters for antenna X. CinX, ClenX and CoutX are the tuning parameters of antenna X. The reader replies with this: <table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 </th><th>3 </th></tr>
<tr>
<th>Content</th><td>0x42(ID)</td><td>64(length)</td><td>0xfc on success</td><td>0xff on success </td></tr>
</table>
</li>
<li>
Clear frequency list used for hopping and add the first frequency as described in the report above. <table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3 .. 5</th><th>6</th><th>7 </th><th>8 </th><th>9 </th><th>10 </th><th>11 </th><th>12 </th><th>13 </th><th>14 </th><th>15 </th><th>16  </th></tr>
<tr>
<th>Content</th><td>0x41(ID)</td><td>length</td><td>4</td><td>freq </td><td>rssi_threshhold(dBm)</td><td>profile_id</td><td>setTune</td><td>tuneEnable1</td><td>Cin1</td><td>Clen1</td><td>Cout1</td><td>tuneEnable2</td><td>Cin2</td><td>Clen2</td><td>Cout2 </td></tr>
</table>
The reader replies with this: <table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 </th><th>3 </th></tr>
<tr>
<th>Content</th><td>0x42(ID)</td><td>64(length)</td><td>0xfe on success</td><td>0xff on success </td></tr>
</table>
</li>
<li>
Set frequency hopping related parameters <table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3 .. 4 </th><th>5 .. 6 </th><th>7 .. 8  </th></tr>
<tr>
<th>Content</th><td>0x41(ID)</td><td>length</td><td>16</td><td>listeningTime</td><td>maxSendingTime</td><td>idleTime </td></tr>
</table>
The reader replies with this: <table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 </th><th>3 </th></tr>
<tr>
<th>Content</th><td>0x42(ID)</td><td>64(length)</td><td>0xfe on success</td><td>0xff on success </td></tr>
</table>
</li>
<li>
Get frequency hopping related parameters <table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 </th></tr>
<tr>
<th>Content</th><td>0x41(ID)</td><td>length</td><td>17 </td></tr>
</table>
The reader replies with this: <table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4 </th><th>5 .. 6 </th><th>7 .. 8 </th><th>9 .. 10 </th><th>11 .. 13 </th><th>14 .. 16 </th><th>17 </th><th>18</th><th>19 </th></tr>
<tr>
<th>Content</th><td>0x42(ID)</td><td>64(length)</td><td>0xfe</td><td>0xff</td><td>profile_id</td><td>listening_time</td><td>max_sending_time</td><td>idle_time</td><td>gui_min_freq</td><td>gui_max_freq</td><td>gui_num_freqs</td><td>rssi_threshold</td><td>act_num_freqs </td></tr>
</table>
</li>
<li>
Continuous modulation test <table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3 .. 5</th><th>6 .. 7 </th></tr>
<tr>
<th>Content</th><td>0x41(ID)</td><td>length</td><td>32</td><td>don't care</td><td>duration in ms </td></tr>
</table>
causes continuous modulation of the RF field for given duration. If duration is 0 it runs until next command received from GUI. The reader replies with this: <table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3 </th></tr>
<tr>
<th>Content</th><td>0x42(ID)</td><td>64(length)</td><td>0xfe</td><td>0xff </td></tr>
</table>
</li>
</ul>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l02007">2007</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0bf612f7a9aff82086a51aab0863a649"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callEnableBootloader </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function disables current application and enables bootloader. Device needs to be reprogrammed afterwards. The format of the report from the host is as follows: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 </th><th>3  </th></tr>
<tr>
<th>Content</th><td>0x55(ID)</td><td>4(length)</td><td>dont_care</td><td>dont_care </td></tr>
</table>
<p>The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 </th></tr>
<tr>
<th>Content</th><td>0x56(ID)</td><td>3(length)</td><td>1 on success </td></tr>
</table>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l02570">2570</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="adfa43c7d6ee4232592efb290888fb847"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callInventory </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function performs a gen2 protocol inventory round according to parameters given by <a class="el" href="usb__commands_8c.html#a4bb268c52ce1fb531876c6d8408e4afa">configGen2()</a>. The format of the report from the host is as follows: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2  </th></tr>
<tr>
<th>Content</th><td>0x31(ID)</td><td>3(length)</td><td>start </td></tr>
</table>
<p>where </p>
<ul>
<li>
start: 1 -&gt; start a new round, 2 -&gt; deliver next tag  </li>
</ul>
<p>The device sends back in a burst mode all the tags using the following report: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4 </th><th>5 </th><th>6 .. 6 + epclen </th></tr>
<tr>
<th>Content</th><td>0x32(ID)</td><td>length</td><td>tags_left</td><td>epclen+pclen</td><td>pc[0]</td><td>pc[1]</td><td>epc </td></tr>
</table>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l01544">1544</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa0084a821c065f158145ea30fbfb1c7a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callInventory6B </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function performs one inventory round using ISO18000-6b protocol. The format of the report from the host is as follows: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4 .. 11 </th><th>12 </th></tr>
<tr>
<th>Content</th><td>0x3f(ID)</td><td>12(length)</td><td>start</td><td>mask</td><td>word_data </td><td>start_address </td></tr>
</table>
<p>where </p>
<ul>
<li>
start: 1 -&gt; start a new round, 2 -&gt; deliver next tag  </li>
<li>
mask: the mask value for GROUP_SELECT_EQ command, 0 will select all tags </li>
<li>
start_address: address where data will be compared </li>
<li>
word_data: data which will be compared </li>
</ul>
<p>The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5 .. 12</th><th>13 .. 15  </th></tr>
<tr>
<th>Content</th><td>0x40(ID)</td><td>13(length)</td><td>tags_left</td><td>rssi(planned)</td><td>8(epclen)</td><td>uid</td><td>used freq </td></tr>
</table>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l01363">1363</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="aafc4e4a9a043305cdd5d3d547112fae7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callInventoryRSSIInternal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="as399x__config_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>&#160;</td>
          <td class="paramname"><em>startInvent</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function performs a gen2 protocol inventory round according to parameters given by <a class="el" href="usb__commands_8c.html#a4bb268c52ce1fb531876c6d8408e4afa">configGen2()</a>. The format of the report from the host is as follows: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2  </th></tr>
<tr>
<th>Content</th><td>0x43(ID)</td><td>3(length)</td><td>start </td></tr>
</table>
<p>where </p>
<ul>
<li>
start: 1 -&gt; start a new round, 2 -&gt; deliver next tag  </li>
</ul>
<p>The device sends back in a burst mode all the tags using the following report: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4 .. 6 </th><th>7</th><th>8 </th><th>9 </th><th>10 .. 10 + epclen </th></tr>
<tr>
<th>Content</th><td>0x44(ID)</td><td>length</td><td>tags_left</td><td>RSSI_value</td><td>base_freq</td><td>epclen+pclen</td><td>pc[0]</td><td>pc[1]</td><td>epc </td></tr>
</table>
<p>where </p>
<ul>
<li>
RSSI_value: upper 4 bits I channel, lower 4 bits Q channel  </li>
<li>
base_freq: base frequency at which the tag was found.  </li>
</ul>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l01624">1624</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6d55f0bf20c6e53f25602cf3f15ee3a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callKillTag </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function kills a gen2 tag. The format of the report from the host is as follows: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 .. 5 </th><th>6  </th></tr>
<tr>
<th>Content</th><td>0x3d(ID)</td><td>7(length)</td><td>kill password</td><td>recom </td></tr>
</table>
<p>where: </p>
<ul>
<li>
recom: see GEN2 standard: table on "XPC_W1 LSBs and a Tag's recomissioned status"  </li>
</ul>
<p>The device sends back the following report: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 </th></tr>
<tr>
<th>Content</th><td>0x3e(ID)</td><td>3(length)</td><td>status </td></tr>
</table>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l02423">2423</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="abc34cc08db5c6dc3443c48ce4625e916"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callLockUnlock </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function locks a gen2 tag. The format of the report from the host is as follows: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 </th><th>3 </th><th>4 .. 7 </th></tr>
<tr>
<th>Content</th><td>0x3b(ID)</td><td>8(length)</td><td>lock_unlock</td><td>memory_space</td><td>access password </td></tr>
</table>
<p>where: </p>
<ul>
<li>
lock_unlock: <table class="doxtable">
<tr>
<td>0</td><td>Unlock </td></tr>
<tr>
<td>1</td><td>Lock </td></tr>
<tr>
<td>2</td><td>Permalock </td></tr>
<tr>
<td>3</td><td>Lock &amp; Permalock </td></tr>
</table>
</li>
<li>
memory_space: <table class="doxtable">
<tr>
<td>0</td><td>Kill password </td></tr>
<tr>
<td>1</td><td>Access password </td></tr>
<tr>
<td>2</td><td>EPC </td></tr>
<tr>
<td>3</td><td>TID </td></tr>
</table>
</li>
</ul>
<p>The device sends back the following report: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 </th></tr>
<tr>
<th>Content</th><td>0x3c(ID)</td><td>3(length)</td><td>status </td></tr>
</table>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l02325">2325</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a9d980864087ec271634f7d835433ccd4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callNXPCommands </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function sends special NXP command to NXP gen2 tags. The format of the report from the host is one of the following </p>
<ul>
<li>
EAS command <table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3 </th><th>4 .. 7 </th></tr>
<tr>
<th>Content</th><td>0x45(ID)</td><td>10(length)</td><td>1</td><td>eas_on</td><td>access pw </td></tr>
</table>
</li>
<li>
Set/Reset protect <table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3 </th><th>4 .. 7 </th></tr>
<tr>
<th>Content</th><td>0x45(ID)</td><td>10(length)</td><td>2</td><td>set_protect</td><td>access pw </td></tr>
</table>
</li>
<li>
Calibrate <table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3 </th><th>4 .. 7 </th></tr>
<tr>
<th>Content</th><td>0x45(ID)</td><td>10(length)</td><td>8</td><td>not_used</td><td>access pw </td></tr>
</table>
</li>
<li>
Change Config <table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3 </th><th>4 .. 7 </th><th>8..9  </th></tr>
<tr>
<th>Content</th><td>0x45(ID)</td><td>10(length)</td><td>9</td><td>not_used</td><td>access pw</td><td>config </td></tr>
</table>
where config is a mask of bit which should be flipped inside config word (XORed).  </li>
</ul>
<p>To all the reader replies with this: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3 .. 4 </th></tr>
<tr>
<th>Content</th><td>0x46(ID)</td><td>5(length)</td><td>status</td><td>config word (only change config) </td></tr>
</table>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l02488">2488</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1e8235cc0b2cb1df5b04a0847f0a0765"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callReadFromTag </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function reads from a previously selected gen2 tag. The format of the report from the host is as follows: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4 </th></tr>
<tr>
<th>Content</th><td>0x37(ID)</td><td>length</td><td>mem_type</td><td>address</td><td>data_len </td></tr>
</table>
<p>where </p>
<ul>
<li>
mem_type:<ul>
<li>
0:reserved membank</li>
<li>
1:EPC membank</li>
<li>
2:TID membank</li>
<li>
3:USER membank</li>
</ul>
</li>
<li>
data_len: data length to read in 16-bit words </li>
</ul>
<p>The device sends back the following report: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3 </th></tr>
<tr>
<th>Content</th><td>0x38(ID)</td><td>length</td><td>status</td><td>num_words_read </td></tr>
</table>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l02244">2244</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a210112a5bcbefccae266f10a543f5b0b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callReadRegister </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function reads one register from the AS399x. The format of the report from the host is as follows: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 </th></tr>
<tr>
<th>Content</th><td>0x1c(ID)</td><td>2(length)</td><td>reg_number </td></tr>
</table>
<p>The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5 </th></tr>
<tr>
<th>Content</th><td>0x1d(ID)</td><td>6(length)</td><td>0 on success</td><td>val0</td><td>val1</td><td>val2 </td></tr>
</table>
<p>val1 and val2 only contain values if reg_number is a deep register (0x12,0x14 .. 0x17). </p>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l00685">685</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a8f9f23c6aa727b21a4a93c9db9e886d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callReadRegisters </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function reads all register in one bulk from AS399x. The format of the report from the host is as follows: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0 </th><th>1  </th></tr>
<tr>
<td>Content</td><td>0x57(ID)</td><td>1(length) </td></tr>
</table>
<table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2 </th><th>.. </th><th>19 </th><th>20 </th><th>21 </th><th>22 </th><th>23 </th><th>24 </th><th>25 </th><th>26 </th><th>27 </th><th>28 </th><th>29 </th><th>30 </th><th>31 </th><th>32 </th><th>33 </th><th>34 </th><th>35 </th><th>36 </th><th>.. </th><th>44  </th></tr>
<tr>
<th>Content </th><td>0x57(ID) </td><td>45(length) </td><td>reg 0x00 </td><td>.. </td><td>reg 0x11 </td><td>reg 0x12-1 </td><td>reg 0x12-2 </td><td>reg 0x12-3 </td><td>reg 0x13 </td><td>reg 0x14-1 </td><td>reg 0x14-2 </td><td>reg 0x14-3 </td><td>reg 0x15-1 </td><td>reg 0x15-2 </td><td>reg 0x15-3 </td><td>reg 0x16-1 </td><td>reg 0x16-2 </td><td>reg 0x16-3 </td><td>reg 0x17-1 </td><td>reg 0x17-2 </td><td>reg 0x17-3 </td><td>reg 0x18 </td><td>.. </td><td>reg 0x1f  </td></tr>
</table>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l01290">1290</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a34b95e06e77ecac99ce20894c4767f99"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callSelectTag </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function singulates a gen2 tag using the given mask for subsequent operations like read/write The format of the report from the host is as follows: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 </th><th>3 .. 3 + mask_length </th></tr>
<tr>
<th>Content</th><td>0x33(ID)</td><td>length</td><td>mask_length</td><td>mask </td></tr>
</table>
<p>The device sends back the following report: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 </th></tr>
<tr>
<th>Content</th><td>0x34(ID)</td><td>3(length)</td><td>status </td></tr>
</table>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l01707">1707</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad6a025a7f083c3f69b3c8cefad179f9e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callSendFirmwareHardwareID </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function sends the firmware/hardware ID to the host. The format of the report from the host is as follows: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 </th></tr>
<tr>
<th>Content</th><td>0x10(ID)</td><td>3(length)</td><td>0 for firmware<br/>
1 for hardware </td></tr>
</table>
<p>The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 .. 47 </th></tr>
<tr>
<th>Content</th><td>0x11(ID)</td><td>length</td><td>Zero terminated string </td></tr>
</table>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l00256">256</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6958165c8330ea8d526edf669d0cb5e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callStartStop </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function starts/stops the automatic scanning procedure. The format of the report from the host is as follows: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3 </th></tr>
<tr>
<th>Content</th><td>0x5d(ID)</td><td>4(length)</td><td>update</td><td>start </td></tr>
</table>
<p>To start inventory rounds update has to be set to 1 and start has to be set to 1. To stop inventory rounds update has to be set to 1 and start has to be set to 0. If update is set to 0 no change of the current settings will be done. The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 </th></tr>
<tr>
<th>Content</th><td>0x5e(ID)</td><td>3(length)</td><td><p class="starttd">current start value</p>
<p class="endtd">Subsequently <a class="el" href="usb__commands_8c.html#aafc4e4a9a043305cdd5d3d547112fae7">callInventoryRSSIInternal()</a> result packages are returned in a dense continuous loop. See there for description. </p>
</td></tr>
</table>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l02611">2611</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2ce0eb2bd02ab534a95f522442fda919"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callUpdateAntennaPower </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function updates the antenna output power table (dBm2Setting). The format of the report from the host is as follows: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4 </th><th>5 </th><th>6 </th><th>7  </th></tr>
<tr>
<th>Content</th><td>0x14(ID)</td><td>number of bytes in report</td><td>x dBm</td><td>Reg15 </td><td>mV LSB </td><td>mV MSB </td><td>x dBm</td><th>...  </th></tr>
</table>
<p>One power table entry consists of 4 Bytes:<br/>
x dBm: applying the following values will set this output power level.<br/>
Reg15: value for the TX output level bits (4:0) in register 0x15 to get the x dBm output level.<br/>
mV: 16bit value which defines the voltage the DAC should be regulated to, to get the x dBm output level.<br/>
For updating the whole antenna output power table (31 table entries) 3 reports have to be sent. Each report contains the entry of the table which should be modified (x dBm) and the new values (Reg15, mV).<br/>
The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 </th></tr>
<tr>
<th>Content</th><td>0x15(ID)</td><td>3(length)</td><td>0 on success </td></tr>
</table>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l00402">402</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6b5124948787e4620bba229d08ea33ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callWriteToTag </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function writes to a previously selected gen2 tag. The format of the report from the host is as follows: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4 .. 7</th><th>8</th><th>9 .. 9 + 2 * data_len </th></tr>
<tr>
<th>Content</th><td>0x35(ID)</td><td>length</td><td>mem_type</td><td>address</td><td>acces_pw</td><td>data_len</td><td>data  </td></tr>
</table>
<p>where </p>
<ul>
<li>
access_pw: if access password is nonzero the tag will be accessed first </li>
<li>
mem_type:<ul>
<li>
0:reserved membank</li>
<li>
1:EPC membank</li>
<li>
2:TID membank</li>
<li>
3:USER membank</li>
</ul>
</li>
<li>
data_len: data length in 16-bit words </li>
</ul>
<p>The device sends back the following report: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3 </th></tr>
<tr>
<th>Content</th><td>0x36(ID)</td><td>3(length)</td><td>status</td><td>num_words_written </td></tr>
</table>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l01777">1777</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4bb268c52ce1fb531876c6d8408e4afa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void configGen2 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function sets and reads various gen2 related settings. The format of the report from the host is as follows: </p>
<table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th><th>5 </th><th>6 </th><th>7 </th><th>8 </th><th>9 </th><th>10 </th><th>11 </th><th>12 </th><th>13  </th></tr>
<tr>
<th>Content </th><td>0x59(ID) </td><td>length </td><td>set_lf </td><td>lf </td><td>set_coding </td><td>coding </td><td>set_session </td><td>session </td><td>set_trext </td><td>trext </td><td>set_tari </td><td>tari </td><td>set_qbegin </td><td>qbegin  </td></tr>
</table>
<p>The values are only being set if the proper set_ value is set to 1.<br/>
 The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th><th>5 </th><th>6 </th><th>7 </th><th>8 </th><th>9 </th><th>10 </th><th>11 </th><th>12 </th><th>13  </th></tr>
<tr>
<th>Content </th><td>0x5a(ID) </td><td>0x40(length) </td><td>reserved(0) </td><td>lf </td><td>reserved(0) </td><td>coding </td><td>reserved(0) </td><td>session </td><td>reserved(0) </td><td>trext </td><td>reserved(0) </td><td>tari </td><td>reserved(0) </td><td>qbegin  </td></tr>
</table>
<p>Values for the different parameters are: </p>
<table class="doxtable">
<tr>
<th>Name</th><th>values </th></tr>
<tr>
<td>lf</td><td>0 = 40 kHz,<br/>
 3 = 80 kHz not AS3992,<br/>
 6 = 160 kHz,<br/>
 8 = 213 kHz,<br/>
 9 = 256 kHz,<br/>
 12 = 320 kHz,<br/>
 15 = 640 kHz  </td></tr>
<tr>
<td>coding</td><td>0 = FM0,<br/>
 1 = Miller2,<br/>
 2 = Miller4,<br/>
 3 = Miller8  </td></tr>
<tr>
<td>session</td><td>0 = S0,<br/>
 1 = S1,<br/>
 2 = S2,<br/>
 3 = SL  </td></tr>
<tr>
<td>trext</td><td>0 = short preamble, pilot tone,<br/>
 1 = long preamble, pilot tone  </td></tr>
<tr>
<td>tari</td><td>0 = 6.25 us,<br/>
 1 = 12.5 us,<br/>
 2 = 25 us  </td></tr>
<tr>
<td>qbegin</td><td>0 .. 15. Initial gen2 round is 2^qbegin long. Please be careful with higher values.  </td></tr>
</table>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l00829">829</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4d0e7a549e38dc3fa3400c2ac7d6a6b9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void genericCommand </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function sends generic command to gen2 tags. TODO: document format </p>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l02735">2735</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="acd7fc5d51767a9bc6e0eb5b7c74c1920"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void readFromTag6B </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function reads from a tag using ISO18000-6b protocol command READ_VARIABLE. The format of the report from the host is as follows: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 .. 9</th><th>10</th><th>11 </th></tr>
<tr>
<th>Content</th><td>0x49(ID)</td><td>12(length)</td><td>uid</td><td>addr</td><td>length_to_read </td></tr>
</table>
<p>where The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4 .. 4+length_to_read </th></tr>
<tr>
<th>Content</th><td>0x50(ID)</td><td>64(length)</td><td>0 for success</td><td>length of data</td><td>data </td></tr>
</table>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l01443">1443</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7ec784645e8f3c1d79cbdddc7286da5d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeRegister </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function writes one register on the AS399x. The format of the report from the host is as follows: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5 </th></tr>
<tr>
<th>Content</th><td>0x1a(ID)</td><td>6(length)</td><td>reg_number</td><td>val0</td><td>val1</td><td>val2 </td></tr>
</table>
<p>val1 and val2 are only used if reg_number is a deep register (0x12,0x14 .. 0x17) if reg_number &gt; 0x80, then an immediate command is executed. The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 </th></tr>
<tr>
<th>Content</th><td>0x1b(ID)</td><td>3(length)</td><td>0 on success </td></tr>
</table>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l00644">644</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="af8d6976460a3b73111e2a912d3d90832"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeToTag6B </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function writes to a tag using ISO18000-6b protocol command WRITE. The format of the report from the host is as follows: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 .. 9</th><th>10</th><th>11</th><th>12 .. 12+length_to_write </th></tr>
<tr>
<th>Content</th><td>0x47(ID)</td><td>length</td><td>uid</td><td>addr</td><td>length_to_write</td><td>data </td></tr>
</table>
<p>where The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4 .. 4+length_to_read </th></tr>
<tr>
<th>Content</th><td>0x48(ID)</td><td>3(length)</td><td>0 for success </td></tr>
</table>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l01494">1494</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a5c2b775bf7bbfb38b6ce8188078754cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="as399x__config_8h.html#a40236c8c1d02f94f1fb4669ca607769d">XDATA</a> <a class="el" href="as399x__config_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> mask[<a class="el" href="global_8h.html#a81cf63c63ff9c5236c24a0ceea9e90fd">EPCLENGTH</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Mask for the read and write command </p>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l00085">85</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="ace606c7581d4f55458cb084cd08f108f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="as399x__config_8h.html#a40236c8c1d02f94f1fb4669ca607769d">XDATA</a> <a class="el" href="as399x__public_8h.html#a24e956eab72b3e331706283669924255">Tag</a> tags_[<a class="el" href="global_8h.html#adf4e7d5cd456c172af91b499031d5649">MAXTAG</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Array of Structures which stores all necessary Information about the Tags. </p>

<p>Definition at line <a class="el" href="usb__commands_8c_source.html#l00082">82</a> of file <a class="el" href="usb__commands_8c_source.html">usb_commands.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Dec 2 2013 10:18:03 for AS399X Firmware by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
